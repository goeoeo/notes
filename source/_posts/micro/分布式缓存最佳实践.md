---
categories: 
- micro
tags:
- 分布式缓存
---

# 缓存常见问题

## 缓存穿透
不存在的数据请求 ；  
恶意请求  

解决方法：   
缓存占位符  
短缓存，比如一分钟

## 缓存击穿

热点数据过期  
大量并发请求  

解决方法：  
唯一DB请求，共享结果  
分布式锁  




## 缓存雪崩
相同的缓存时间  
缓存同时过期  
大量请求落到DB  

解决方法:  
缓存过期时间加上随机偏差  
分布式缓存，防止单节点故障  

## 数据一致性




# 单行查询的缓存自动管理

## 完整数据查询
### 基于主键查询
* 借鉴msyql聚簇索引的设计理念
* 基于主键缓存
* 返回单行完整数据
* 自动生成代码

### 基于单列唯一索引查询
### 基于多列唯一索引查询


# 多行查询的缓存
## 不易变的列表
* 比如店铺商品
* ID放在redis的sorted set
* 单列DB查询+缓存
* 修改友好，单条缓存删除
* mapreduce并发请求

##  易变且分页的列表

## 缓存分发算法

## 缓存需要保证如下
* 怎么存放缓存数据
* 考虑缓存穿透、击穿、雪崩
* 数据一致性
* 监控缓存使用情况


