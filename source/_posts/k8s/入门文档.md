---
categories: 
- k8s
tags:
- k8s
---
## Kubernetes简介
Kubernetes（简称K8S，K和S之间有8个字母）是用于自动部署，扩展和管理容器化应用程序的开源系统。它将组成应用程序的容器组合成逻辑单元，
以便于管理和服务发现。Kubernetes 源自Google 15 年生产环境的运维经验，同时凝聚了社区的最佳创意和实践。  


## Kubernetes特性
* 服务发现与负载均衡:无需修改你的应用程序即可使用陌生的服务发现机制。
* 存储编排:自动挂载所选存储系统，包括本地存储。
* Secret和配置管理: 部署更新Secrets和应用程序的配置时不必重新构建容器镜像，且不必将软件堆栈配置中的秘密信息暴露出来。
* 批量执行: 除了服务之外，Kubernetes还可以管理你的批处理和CI工作负载，在期望时替换掉失效的容器。
* 水平扩缩:使用一个简单的命令、一个UI或基于CPU使用情况自动对应用程序进行扩缩。
* 自动化上线和回滚: Kubernetes会分步骤地将针对应用或其配置的更改上线，同时监视应用程序运行状况以确保你不会同时终止所有实例。
* 自动装箱:根据资源需求和其他约束自动放置容器，同时避免影响可用性。
* 自我修复:重新启动失败的容器，在节点死亡时替换并重新调度容器，杀死不响应用户定义的健康检查的容器。


## Minikube
Minikube是一种轻量级的Kubernetes实现，可在本地计算机上创建VM并部署仅包含一个节点的简单集群，Minikube可用于Linux、MacOS和Windows系统。
Minikube CLI提供了用于引导集群工作的多种操作，包括启动、停止、查看状态和删除。

## Kubernetes核心组件

### master组件
* apiserver 集群统一入口，以restful方式，交给etcd存储
* scheduler 节点调度，选择node节点部署应用
* controller-manager 处理集群中常规后台任务，一个资源对应一个控制器
* etcd 分布式存储数据库，保存集群相关数据

### Node
* kubelet master派到node节点代表，管理本机容器
* kube-proxy 提供网络代理、负载均衡等操作


## k8s核心概念

### Pod 
* k8s中最小的部署单元
* 一组容器的集合
* 一个Pod中的容器共享网络、存储
* 生命周期是短暂的

### controller
* 确保预期的pod的副本的数量
* 无状态的应用部署
* 有状态的应用部署
> 确保所有的node运行一个pod,一次性任务和定时任务



### service
* 定义一组pod的访问规则



## k8s 资源类型

### 名称空间级别的资源
* 工作负载型资源：Pod、ReplicaSet、Deployment、StatefulSet、DaemonSet、Job、CronJob
* 服务发现及负载均衡型资源：Service 、 Ingress
* 存储资源：Volume、CSI（容器存储接口，可以扩展各种各样的第三方存储卷）
* 特殊类型的存储卷：ConfigMap、Secret、DownwardAPI

### 集群级别
Namespace、Node、Role、ClusterRole、RoleBinding、ClusterRoleBinding

### 元数据类型
HPA、PodTemplate、LimitRange

## 必须存在的属性

|参数名|字段类型|说明|
|:---:|:---:|:---:|
|version|String|这里指k8s api的版本，目前基本上是v1,可以使用kubectl api-versions 命令查询|
|kind|String|这里指的是yaml文件定义的资源类型和角色，比如：Pod|
|metadata|Object|元数据对象，固定值就写metadata|
|metadata.name|string|元数据对象的名字，这里由我们编写，比如命名的Pod的名字|
|metadata.namespace|string|元数据对象的命名空间，由我们自身定义|
|Spec|Object|详细定义对象，固定值|
|spec.containers[]|list|这里是spec对象的容器列表定义，是个列表|
|spec.containers[].name|string|定义容器的名称|
|spec.containers[].image|string|定义要用到的镜像名称|
|spec.containers[].imagePullPolicy|string|定义镜像拉取策略，Always(总是拉取最新镜像),Never(拉取本地镜像，没有就不用),IfNotPresent(如果本地没有镜像则拉取)|
||||
||||
||||
||||
||||
||||
||||
||||
||||
||||
||||
||||
||||
||||








































